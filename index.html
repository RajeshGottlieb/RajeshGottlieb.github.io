<!DOCTYPE html>
<!-- vim: set ft=html ts=2 sw=2 expandtab: -->
<html>
  <head>
    <title>Calculator</title>
  </head>
<body>

<p>Enter mathematical expression:</p>

<input type="text" id="myText" size="120" value="">
<br>
<br>

<button onclick="myFunction()">Evaluate</button>
<button onclick="myClear()">Clear</button>
<button onclick="myClearAll()">Clear All</button>
<p id="output"></p>

<script type="text/javascript" src="math.js"></script>

<script>

const parser = math.parser()
var line_separator = ""

function myFunction() {
  // output the user's expression
  var expr = document.getElementById("myText").value
  document.getElementById("output").innerHTML += line_separator + ">> " + expr

  line_separator = "<br>"

  // Evaluate an expression. Returns the result of the expression.
  var result = parser.evaluate(expr)

  // output the evaluated expression
  document.getElementById("output").innerHTML += line_separator + result
}

function myClear() {
  document.getElementById("myText").value = ''
  document.getElementById("output").innerHTML = ""

  line_separator = ""
}

function myClearAll() {
  myClear()

  // Completely clear the parser’s scope.
  parser.clear()
}

// Let the user also use the Enter key to evaluate the expression
document.getElementById("myText").addEventListener("keyup", function(event) {
    event.preventDefault();
    if (event.keyCode === 13) { // enter
        myFunction()
    } else if (event.keyCode === 38) { // up arrow
        // TODO replace input with older historical value
    } else if (event.keyCode === 40) { // down arrow
        // TODO replace input with newer historical value
    }
});


</script>

</body>
</html>
